# covid19splicing
Betacoronavirus splicing analysis

This repository contains the code for running the analysis of "Betacoronavirus-specific alternate splicing".  Each of the figures in the manuscript is generated by the code in the directory named after it.  The first step in generating the input data for the figures is running the Snakemake pipeline that will download the experimental data, process and align it to the genome, quantify the mean number of isoforms in each sample and run HBA-DEALS to detect differential expression and differential splicing.

Running the pipeline:
The 'Snakemake' directory contains the code for the Snakemake pipeline and in addition scripts for running it using the Slurm workload manager and the Singularity software.  A singularity container can be created using the sing_img.def file.  This container should include all the programs and R packages used by the pipeline.  The file run_rsem_pipeline.sh will submit the different datasets to be processed on an HPC infrastructure via Slurm.  The results will be created in the 'Snakemake' directory.  The config.yaml contains the paths to the fasta and gtf files of the human genome, which are required for alignment and transcript quantification. 

Generating the figures:
The output of the pipeline is also provided in the directory 'HBA-DEALS-covid19_output'.  This is used as input by the scripts that generate the figures.  In addition, some of the figures use the content of external databases, that can be downloaded directly from the websites of those databases.  


